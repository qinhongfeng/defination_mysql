#团购小程序打卡数据:4月1号至30号的打卡数据
-- 老师艺名	日期	时间段	阶段	班型	课程名称	学员ID	学员名称	考勤状态	是否小程序打卡	正课首课开课月份


select 
au.nickname 老师艺名
,FROM_UNIXTIME(l.start_time)  上课时间
,date(FROM_UNIXTIME(l.start_time)) 上课日期
,time(FROM_UNIXTIME(l.start_time)) 上课时间段
,cc.name 阶段
,case p.package_type when 1 then '1V1' when 2 then '2V2' when 3 then '3V3' when 4 then '4V4' when 5 then '5V5' when 6 then '6V6' else '其他' end 班型
,c1.chapter_name 课程名称
,u.id 学员ID
,u.name 学员姓名
,case ls.check_status when 0 then '未签到' when 1 then '签到' when  2 then '请假' when 3 then '旷课' when 4 then '取消' else '' end 考勤状态
,case l.course_type when 1 then '正课' when 2 then '试听课' when 3 then '活动课' when 6 then '补课' else l.course_type end 课程类型
,	(SELECT
		date(FROM_UNIXTIME(l.start_time))
	FROM
		ol_live_student ls
		INNER JOIN ol_live l ON l.id = ls.live_id
	WHERE
		ls.student_id = u.id
		AND course_type = 1 
		and l.`status`=1
	and ls.check_status in (1,3)
	ORDER BY
		start_time ASC 
		LIMIT 1 
	) '首课时间'
,case ls.work_status when 1 then '已提交' when 0 then '未提交' else '' end '是否提交作业'
from ol_live l
left join ol_live_student ls on ls.live_id=l.id
left join ol_admin_user au on l.teacher_id=au.id
left join ol_order o on o.user_id = ls.student_id
left join ol_user u on u.id =ls.student_id
left join ol_package p on p.id=o.package_id
left join ol_course_category cc on l.cate_sid= cc.id
left join ol_chapter_number cn on cn.id=l.cn_id
left join ol_chapter c1 on c1.id=cn.chapter_id

where l.start_time BETWEEN UNIX_TIMESTAMP('2019-04-01') and UNIX_TIMESTAMP('2019-05-01')
and l.`status`=1
and l.live_status=2
group by au.nickname,上课时间,学员ID
